<!DOCTYPE html>

<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<title>Meter Point Administration Number - Wikipedia</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Meter_Point_Administration_Number","wgTitle":"Meter Point Administration Number","wgCurRevisionId":876637744,"wgRevisionId":876637744,"wgArticleId":2846153,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["All articles with dead external links","Articles with dead external links from March 2013","CS1 maint: Archived copy as title","Articles with dead external links from May 2016","Electric power in the United Kingdom","Electricity meters"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Meter_Point_Administration_Number","wgRelevantArticleId":2846153,"wgRequestId":"XMAwPgpAICMAAGJ84uYAAACD","wgCSPNonce":false,"wgIsProbablyEditable":true,"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgFlaggedRevsParams":{"tags":{}},"wgStableRevisionId":null,"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgPopupsReferencePreviews":false,"wgPopupsConflictsWithNavPopupGadget":false,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en","usePageImages":true,"usePageDescriptions":true},"wgMFDisplayWikibaseDescriptions":{"search":true,"nearby":true,"watchlist":true,"tagline":false},"wgRelatedArticles":null,"wgRelatedArticlesUseCirrusSearch":true,"wgRelatedArticlesOnlyUseCirrusSearch":false,"wgWMESchemaEditAttemptStepOversample":false,"wgPoweredByHHVM":true,"wgULSCurrentAutonym":"English","wgNoticeProject":"wikipedia","wgCentralNoticeCookiesToDelete":[],"wgCentralNoticeCategoriesUsingLegacy":["Fundraising","fundraising"],"wgWikibaseItemId":"Q6823505","wgCentralAuthMobileDomain":false,"wgEditSubmitButtonLabelPublish":true});mw.loader.state({"ext.gadget.charinsert-styles":"ready","ext.globalCssJs.user.styles":"ready","ext.globalCssJs.site.styles":"ready","site.styles":"ready","noscript":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","ext.globalCssJs.site":"ready","user":"ready","user.options":"ready","user.tokens":"loading","ext.cite.styles":"ready","ext.pygments":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.toc.styles":"ready","wikibase.client.init":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","ext.wikimediaBadges":"ready","ext.3d.styles":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@0tffind",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});RLPAGEMODULES=["ext.cite.ux-enhancements","site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","ext.gadget.teahouse","ext.gadget.ReferenceTooltips","ext.gadget.watchlist-notice","ext.gadget.DRN-wizard","ext.gadget.charinsert","ext.gadget.refToolbar","ext.gadget.extra-toolbar-buttons","ext.gadget.switcher","ext.centralauth.centralautologin","mmv.head","mmv.bootstrap.autostart","ext.popups","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.uls.eventlogger","ext.uls.init","ext.uls.compactlinks","ext.uls.interface","ext.quicksurveys.init","ext.centralNotice.geoIP","ext.centralNotice.startUp","skins.vector.js"];mw.loader.load(RLPAGEMODULES);});</script>
<link href="/w/load.php?lang=en&amp;modules=ext.3d.styles%7Cext.cite.styles%7Cext.pygments%2CwikimediaBadges%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.toc.styles%7Cskins.vector.styles%7Cwikibase.client.init&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta content="" name="ResourceLoaderDynamicStyles"/>
<link href="/w/load.php?lang=en&amp;modules=ext.gadget.charinsert-styles&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
<link href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
<meta content="MediaWiki 1.34.0-wmf.1" name="generator"/>
<meta content="origin" name="referrer"/>
<meta content="origin-when-crossorigin" name="referrer"/>
<meta content="origin-when-cross-origin" name="referrer"/>
<link href="android-app://org.wikipedia/http/en.m.wikipedia.org/wiki/Meter_Point_Administration_Number" rel="alternate"/>
<link href="/w/index.php?title=Meter_Point_Administration_Number&amp;action=edit" rel="alternate" title="Edit this page" type="application/x-wiki"/>
<link href="/w/index.php?title=Meter_Point_Administration_Number&amp;action=edit" rel="edit" title="Edit this page"/>
<link href="/static/apple-touch/wikipedia.png" rel="apple-touch-icon"/>
<link href="/static/favicon/wikipedia.ico" rel="shortcut icon"/>
<link href="/w/opensearch_desc.php" rel="search" title="Wikipedia (en)" type="application/opensearchdescription+xml"/>
<link href="//en.wikipedia.org/w/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link href="//creativecommons.org/licenses/by-sa/3.0/" rel="license"/>
<link href="https://en.wikipedia.org/wiki/Meter_Point_Administration_Number" rel="canonical"/>
<link href="//login.wikimedia.org" rel="dns-prefetch"/>
<link href="//meta.wikimedia.org" rel="dns-prefetch"/>
<!--[if lt IE 9]><script src="/w/load.php?lang=qqx&amp;modules=html5shiv&amp;only=scripts&amp;skin=fallback&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-Meter_Point_Administration_Number rootpage-Meter_Point_Administration_Number skin-vector action-view">
<div class="noprint" id="mw-page-base"></div>
<div class="noprint" id="mw-head-base"></div>
<div class="mw-body" id="content" role="main">

<div class="mw-body-content" id="siteNotice"><!-- CentralNotice --></div>
<div class="mw-indicators mw-body-content">
</div>
<h1 class="firstHeading" id="firstHeading" lang="en">Meter Point Administration Number</h1>
<div class="mw-body-content" id="bodyContent">
<div class="noprint" id="siteSub">From Wikipedia, the free encyclopedia</div>
<div id="contentSub"></div>
<div id="jump-to-nav"></div>
Jump to navigation
Jump to search
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output"><p>A <b>Meter Point Administration Number</b>, also known as <b>MPAN</b>, <b>Supply Number</b> or <b>S-Number</b>, is a 21-digit reference used in Great Britain to uniquely identify electricity supply points such as individual domestic residences. The gas equivalent is the Meter Point Reference Number. The system was introduced in 1998 in order to provide a competitive environment for the electricity companies, and allows consumers to switch their supplier easily as well as simplifying administration. Although the name suggests that an MPAN refers to a particular meter, an MPAN can have several meters associated with it, or indeed none where it is an unmetered supply. A supply receiving power from the network operator (DNO) has an Import MPAN, while generation and microgeneration projects feeding back into the DNO network are given Export MPANs.
<span style="border: 3px solid blue; color:blue;font-weight: bold">1</span></p>
<div class="toc" id="toc"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><span class="tocnumber">1</span> <span class="toctext">Structure</span>
<ul>
<li class="toclevel-2 tocsection-2"><span class="tocnumber">1.1</span> <span class="toctext">Profile Class (PC)</span></li>
<li class="toclevel-2 tocsection-3"><span class="tocnumber">1.2</span> <span class="toctext">Meter Time Switch Class (MTC)</span></li>
<li class="toclevel-2 tocsection-4"><span class="tocnumber">1.3</span> <span class="toctext">Line Loss Factor Class (LLFC)</span></li>
<li class="toclevel-2 tocsection-5"><span class="tocnumber">1.4</span> <span class="toctext">Core</span>
<ul>
<li class="toclevel-3 tocsection-6"><span class="tocnumber">1.4.1</span> <span class="toctext">Distributor ID</span></li>
<li class="toclevel-3 tocsection-7"><span class="tocnumber">1.4.2</span> <span class="toctext">Check digit</span></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><span class="tocnumber">2</span> <span class="toctext">MPAN state</span></li>
<li class="toclevel-1 tocsection-9"><span class="tocnumber">3</span> <span class="toctext">Export MPANs</span>
<ul>
<li class="toclevel-2 tocsection-10"><span class="tocnumber">3.1</span> <span class="toctext">Microgeneration</span></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><span class="tocnumber">4</span> <span class="toctext">Metered Supply Point</span></li>
<li class="toclevel-1 tocsection-12"><span class="tocnumber">5</span> <span class="toctext">Metering Code of Practice</span></li>
<li class="toclevel-1 tocsection-13"><span class="tocnumber">6</span> <span class="toctext">Unmetered supplies</span></li>
<li class="toclevel-1 tocsection-14"><span class="tocnumber">7</span> <span class="toctext">Standard Settlement Configuration (SSC)</span></li>
<li class="toclevel-1 tocsection-15"><span class="tocnumber">8</span> <span class="toctext">Meter Point Administration System</span></li>
<li class="toclevel-1 tocsection-16"><span class="tocnumber">9</span> <span class="toctext">ECOES</span></li>
<li class="toclevel-1 tocsection-17"><span class="tocnumber">10</span> <span class="toctext">See also</span></li>
<li class="toclevel-1 tocsection-18"><span class="tocnumber">11</span> <span class="toctext">External links</span></li>
<li class="toclevel-1 tocsection-19"><span class="tocnumber">12</span> <span class="toctext">References</span></li>
</ul>
</div>
<h2><span class="mw-headline" id="Structure">Structure</span></h2>
<p>An MPAN is commonly separated into two sections: the core and the top line data. The core is the final 13 digits and is the unique identifier. The top line data gives information about the characteristics of the supply and is the responsibility of the supplier.
<span style="border: 3px solid blue; color:blue;font-weight: bold">2</span></p><p>The full MPAN is required to be depicted on electricity bills (the boxes on the top and bottom line are generally unaligned).
<span style="border: 3px solid blue; color:blue;font-weight: bold">3</span></p>
<div class="center"><div class="floatnone"><img alt="MPAN Format.jpg" data-file-height="308" data-file-width="499" decoding="async" height="308" src="https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https://upload.wikimedia.org/wikipedia/en/5/59/MPAN_Format.jpg" srcset width="499"/></div></div>
<p>The core data is on the second line, the supplementary data on the first.
<span style="border: 3px solid blue; color:blue;font-weight: bold">4</span></p>
<h3><span id="Profile_Class_.28PC.29"></span><span class="mw-headline" id="Profile_Class_(PC)">Profile Class (PC)<span id="PC"></span></span></h3>
<p>The first two digits of a full MPAN reflect its profile class.
<span style="border: 3px solid blue; color:blue;font-weight: bold">5</span></p>
<table >
<tbody><tr>
<th>00
</th>
<td>Half-hourly supply (import and export)
</td></tr>
<tr>
<th>01
</th>
<td>Domestic unrestricted
</td></tr>
<tr>
<th>02
</th>
<td>Domestic Economy meter of two or more rates
</td></tr>
<tr>
<th>03
</th>
<td>Non-domestic unrestricted
</td></tr>
<tr>
<th>04
</th>
<td>Non-domestic Economy 7
</td></tr>
<tr>
<th>05
</th>
<td>Non-domestic, with maximum demand (MD) recording capability and with load factor (LF) less than or equal to 20%
</td></tr>
<tr>
<th>06
</th>
<td>Non-domestic, with MD recording capability and with LF less than or equal to 30% and greater than 20%
</td></tr>
<tr>
<th>07
</th>
<td>Non-domestic, with MD recording capability and with LF less than or equal to 40% and greater than 30%
</td></tr>
<tr>
<th>08
</th>
<td>Non-domestic, with MD recording capability and with LF greater than 40% (also all non-half-hourly export MSIDs)
</td></tr></tbody></table><a name="table1"><span style='border: 3px solid #00cc00;color:#00cc00;font-size: 24px;'>1</span></a>
<p>Profile class 00 supplies are half-hourly (HH) metered, i.e. they record electricity consumption for every half hour of every day, and supplies of the other profile classes are non-half-hourly (NHH) metered. A NHH supply must be upgraded to HH where:
<span style="border: 3px solid blue; color:blue;font-weight: bold">6</span></p>
<table class="cquote pullquote" role="presentation" style="margin:auto; border-collapse: collapse; border: none; background-color: transparent; width: auto;">
<tbody><tr>
<td style="width: 20px; vertical-align: top; border: none; color: #B2B7F2; font-size: 40px; font-family: 'Times New Roman', Times, serif; font-weight: bold; line-height: .6em; text-align: left; padding: 10px 10px;">â€œ
</td>
<td style="vertical-align: top; border: none; padding: 4px 10px;">Any Metering System where the average of the maximum monthly electrical demands in the three months of highest demand, either in:
<dl><dd>a. the previous twelve months; or</dd>
<dd>b. the period since the most recent Significant Change of Demand (whichever is the shorter)</dd></dl>
<p>exceeds 100kW.
<span style="border: 3px solid blue; color:blue;font-weight: bold">7</span></p>
</td>
<td style="width: 20px; vertical-align: bottom; border: none; color: #B2B7F2; font-size: 40px; font-family: 'Times New Roman', Times, serif; font-weight: bold; line-height: .6em; text-align: right; padding: 10px 10px;">â€
</td></tr>
</tbody></table>
<p>HH data is recorded by the meter and collected by an onsite download, or by remote communication methods such as GSM, SMS, GPRS or telephone line.
<span style="border: 3px solid blue; color:blue;font-weight: bold">8</span></p><p>Domestic NHH import MPANs always have a profile class of 01 or 02. Domestic NHH export MPANs are allocated a profile class of 08.
<span style="border: 3px solid blue; color:blue;font-weight: bold">9</span></p>
<h3><span id="Meter_Time_Switch_Class_.28MTC.29"></span><span class="mw-headline" id="Meter_Time_Switch_Class_(MTC)">Meter Time Switch Class (MTC)</span></h3>
<p>The MTC is a 3 digit code that reflects the various registers a meter may have, such as a single rate, day/night split, or a seasonal time of day.
<span style="border: 3px solid blue; color:blue;font-weight: bold">10</span></p>
<table >
<caption>MTC Ranges
</caption>
<tbody><tr>
<td>001â€“399</td>
<td>DNO specific
</td></tr>
<tr>
<td>400â€“499</td>
<td>Reserved
</td></tr>
<tr>
<td>500â€“509</td>
<td>Codes for related Metering Systems â€“ common across the Industry
</td></tr>
<tr>
<td>510â€“799</td>
<td>Codes for related Metering Systems â€“ DNO specific
</td></tr>
<tr>
<td>800â€“999</td>
<td>Codes common across the Industry
</td></tr></tbody></table><a name="table2"><span style='border: 3px solid #00cc00;color:#00cc00;font-size: 24px;'>2</span></a>
<h3><span id="Line_Loss_Factor_Class_.28LLFC.29"></span><span class="mw-headline" id="Line_Loss_Factor_Class_(LLFC)">Line Loss Factor Class (LLFC)</span></h3>
<p>The Line Loss Factor Class or LLFC is used to identify the related Distribution Use of System (DUoS) charges for the MPAN. The figure reflects both the amount of distribution infrastructure used to supply the exit point and the amount of energy lost through heating of cables, transformers, etc.
<span style="border: 3px solid blue; color:blue;font-weight: bold">11</span></p>
<h3><span class="mw-headline" id="Core">Core</span></h3>
<p>The MPAN core is the final 13 digits of the MPAN, and uniquely identifies an exit point. It consists of a two-digit Distributor ID, followed by an eight-digit unique identifier, then by two digits and a single check digit.
<span style="border: 3px solid blue; color:blue;font-weight: bold">12</span></p>
<h4><span class="mw-headline" id="Distributor_ID">Distributor ID</span></h4>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><img alt="" class="thumbimage" data-file-height="569" data-file-width="375" decoding="async" height="455" src="https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https:https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Distribution_Network_Operators.PNG/300px-Distribution_Network_Operators.PNG" srcset width="300"/> <div class="thumbcaption"><div class="magnify"></div><div style='border: 3px solid red'><center><h1 style='color:red'>1</h1></center></div>Map of DNO licence areas</div></div></div>
<p>Great Britain is divided into fourteen distribution areas. For each area a single company, the distribution network operator, has a licence to distribute electricity. They effectively carry electricity from the National Grid to the exit points (each having a unique MPAN and a possibility of several meters) where the customers are.  The owner of the distribution network charges electricity suppliers for carrying the electricity in their network. Their DNO licensed regions are the same geographic areas as the former nationalised electricity boards.
<span style="border: 3px solid blue; color:blue;font-weight: bold">13</span></p>
<table >
<caption>DNOs
</caption>
<tbody><tr>
<th>ID
</th>
<th>Name
</th>
<th>Operator
</th>
<th>Phone Number
</th>
<th>Market Participant ID
</th>
<th>GSP Group ID
</th></tr>
<tr>
<th>10
</th>
<td>Eastern England
</td>
<td>UK Power Networks
</td>
<td>0800 029 4285
</td>
<td>EELC
</td>
<td>_A
</td></tr>
<tr>
<th>11
</th>
<td>East Midlands
</td>
<td>Western Power Distribution
</td>
<td>0800 096 3080
</td>
<td>EMEB
</td>
<td>_B
</td></tr>
<tr>
<th>12
</th>
<td>London
</td>
<td>UK Power Networks
</td>
<td>0800 029 4285
</td>
<td>LOND
</td>
<td>_C
</td></tr>
<tr>
<th>13
</th>
<td>Merseyside and Northern Wales
</td>
<td>SP Energy Networks
</td>
<td>0330 10 10 444
</td>
<td>MANW
</td>
<td>_D
</td></tr>
<tr>
<th>14
</th>
<td>West Midlands
</td>
<td>Western Power Distribution
</td>
<td>0800 096 3080
</td>
<td>MIDE
</td>
<td>_E
</td></tr>
<tr>
<th>15
</th>
<td>North Eastern England
</td>
<td>Northern Powergrid
</td>
<td>0800 011 3332
</td>
<td>NEEB
</td>
<td>_F
</td></tr>
<tr>
<th>16
</th>
<td>North Western England
</td>
<td>Electricity North West
</td>
<td>0800 048 1820
</td>
<td>NORW
</td>
<td>_G
</td></tr>
<tr>
<th>17
</th>
<td>Northern Scotland
</td>
<td>Scottish &amp; Southern Electricity Networks
</td>
<td>0800 048 3516
</td>
<td>HYDE
</td>
<td>_P
</td></tr>
<tr>
<th>18
</th>
<td>Southern Scotland
</td>
<td>SP Energy Networks
</td>
<td>0330 10 10 444
</td>
<td>SPOW
</td>
<td>_N
</td></tr>
<tr>
<th>19
</th>
<td>South Eastern England
</td>
<td>UK Power Networks
</td>
<td>0800 029 4285
</td>
<td>SEEB
</td>
<td>_J
</td></tr>
<tr>
<th>20
</th>
<td>Southern England
</td>
<td>Scottish &amp; Southern Electricity Networks
</td>
<td>0800 048 3516
</td>
<td>SOUT
</td>
<td>_H
</td></tr>
<tr>
<th>21
</th>
<td>Southern Wales
</td>
<td>Western Power Distribution
</td>
<td>0800 096 3080
</td>
<td>SWAE
</td>
<td>_K
</td></tr>
<tr>
<th>22
</th>
<td>South Western England
</td>
<td>Western Power Distribution
</td>
<td>0800 096 3080
</td>
<td>SWEB
</td>
<td>_L
</td></tr>
<tr>
<th>23
</th>
<td>Yorkshire
</td>
<td>Northern Powergrid
</td>
<td>0800 011 3332
</td>
<td>YELG
</td>
<td>_M
</td></tr></tbody></table><a name="table3"><span style='border: 3px solid #00cc00;color:#00cc00;font-size: 24px;'>3</span></a>
<p>In addition to the distribution network operators noted above who are licensed for a specific geographic area, there are also independent distribution network operators (IDNOs). These own and operate electricity distribution networks which are mostly network extensions connected to the existing distribution network, e.g. to serve new housing developments.
<span style="border: 3px solid blue; color:blue;font-weight: bold">14</span></p><p>Scottish Hydro Electric Power Distribution also provide distribution services in South Scotland as an IDNO and Southern Electric Power Distribution provide IDNO services in all other England and Wales areas. Other IDNOs have no "base" area.
<span style="border: 3px solid blue; color:blue;font-weight: bold">15</span></p>
<table >
<caption>Independent Distribution Network Operators
</caption>
<tbody><tr>
<th>ID
</th>
<th>Name
</th>
<th>Licensee
</th>
<th>Market Participant Id
</th></tr>
<tr>
<th>24
</th>
<td>GTC
</td>
<td>Independent Power Networks
</td>
<td>IPNL
</td></tr>
<tr>
<th>25
</th>
<td>ESP Electricity
</td>
<td>ESP Electricity
</td>
<td>LENG
</td></tr>
<tr>
<th>26
</th>
<td>Energetics
</td>
<td>Global Utilities Connections (Electric) Ltd
</td>
<td>GUCL
</td></tr>
<tr>
<th>27
</th>
<td>GTC
</td>
<td>The Electricity Network Company Ltd
</td>
<td>ETCL
</td></tr>
<tr>
<th>28
</th>
<td>EDF IDNO
</td>
<td>UK Power Networks (IDNO) Ltd
</td>
<td>EDFI
</td></tr>
<tr>
<th>29
</th>
<th>
</th>
<td>Harlaxton Energy Networks Ltd
</td>
<td>HARL
</td></tr>
<tr>
<th>30
</th>
<th>
</th>
<td>Peel Electricity Networks Ltd
</td>
<td>PENL
</td></tr>
<tr>
<th>31
</th>
<th>
</th>
<td>UK Power Distributions Ltd
</td>
<td>UKPD
</td></tr>
<tr>
<th>32
</th>
<td>UDN
</td>
<td>Utility Distribution Networks Ltd
</td>
<td>UDNL
</td></tr>
<tr>
<th>35
</th>
<td>FEAL
</td>
<td>Fulcrum Electricity Assets Ltd
</td>
<td>FEAL
</td></tr></tbody></table><a name="table4"><span style='border: 3px solid #00cc00;color:#00cc00;font-size: 24px;'>4</span></a>
<h4><span class="mw-headline" id="Check_digit">Check digit</span></h4>
<p>The final digit in the MPAN is the check digit, and validates the previous 12 (the core) using a modulus 11 test. The check digit is calculated thus:
<span style="border: 3px solid blue; color:blue;font-weight: bold">16</span></p>
<ol><li>Multiply the first digit by 3</li>
<li>Multiply the second digit by the next prime number (5)</li>
<li>Repeat this for each digit (missing 11 out on the list of prime numbers for the purposes of this algorithm)</li>
<li>Add up all these products</li>
<li>The check digit is the sum modulo 11 modulo 10.</li></ol>
<table class="wikitable collapsible autocollapse">
<tbody><tr>
<th>MPAN verification examples
</th></tr>
<tr>
<td>The algorithm in Java is:
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kt">int</span> <span class="nf">checkDigit</span><span class="o">(</span><span class="n">String</span> <span class="n">toCheck</span><span class="o">)</span> <span class="o">{</span>
  <span class="kt">int</span><span class="o">[]</span> <span class="n">primes</span> <span class="o">=</span> <span class="o">{</span><span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">19</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span> <span class="mi">43</span><span class="o">};</span>
  <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">primes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">sum</span> <span class="o">+=</span> <span class="n">Character</span><span class="o">.</span><span class="na">getNumericValue</span><span class="o">(</span><span class="n">toCheck</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">*</span> <span class="n">primes</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">sum</span> <span class="o">%</span> <span class="mi">11</span> <span class="o">%</span> <span class="mi">10</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
<p>In Matlab:
<span style="border: 3px solid blue; color:blue;font-weight: bold">17</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">function</span><span class="w"> </span>check <span class="p">=</span><span class="w"> </span><span class="nf">checkdigits</span><span class="p">(</span>MPANCore<span class="p">)</span><span class="w"></span>
<span class="c">% MPANCore is a cell array of 13 digit strings.</span>
<span class="c">% Check is a boolean vector the same size as MPANCore.</span>
<span class="c">% (100,000 MPANs in 0.05 seconds.)</span>

<span class="n">core</span> <span class="p">=</span> <span class="n">double</span><span class="p">(</span><span class="n">char</span><span class="p">(</span><span class="n">MPANCore</span><span class="p">)</span><span class="o">'</span><span class="p">)</span><span class="o">-</span><span class="mi">48</span><span class="p">;</span> <span class="n">c</span> <span class="p">=</span> <span class="n">core</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,:);</span>
<span class="n">p</span> <span class="p">=</span> <span class="p">[</span><span class="mi">3</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">13</span> <span class="mi">17</span> <span class="mi">19</span> <span class="mi">23</span> <span class="mi">29</span> <span class="mi">31</span> <span class="mi">37</span> <span class="mi">41</span> <span class="mi">43</span><span class="p">]</span><span class="o">'</span> <span class="o">*</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="n">m</span> <span class="p">=</span> <span class="nb">mod</span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.*</span><span class="n">c</span><span class="p">),</span><span class="mi">11</span><span class="p">),</span><span class="mi">10</span><span class="p">);</span> <span class="n">k</span> <span class="p">=</span> <span class="n">core</span><span class="p">(</span><span class="mi">13</span><span class="p">,:);</span> <span class="n">check</span> <span class="p">=</span> <span class="n">m</span><span class="o">==</span><span class="n">k</span><span class="p">;</span>
</pre></div>
<p>In Pascal / Delphi:
<span style="border: 3px solid blue; color:blue;font-weight: bold">18</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">function</span> <span class="nf">CheckDigit</span><span class="p">(</span><span class="n">MPANCore</span> <span class="o">:</span> <span class="k">array</span> <span class="k">of</span> <span class="kt">Byte</span><span class="p">)</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
<span class="k">const</span>
  <span class="n">Primes</span> <span class="o">:</span> <span class="k">array</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">11</span><span class="p">]</span> <span class="k">of</span> <span class="kt">Byte</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">19</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span> <span class="mi">43</span><span class="p">)</span><span class="o">;</span>
<span class="k">var</span>
  <span class="n">i</span> <span class="o">:</span> <span class="kt">integer</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="bp">Result</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">;</span>

  <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">11</span> <span class="k">do</span>
    <span class="bp">Result</span> <span class="o">:=</span> <span class="bp">Result</span> <span class="o">+</span> <span class="p">(</span><span class="n">MPANCore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">Primes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">;</span>

  <span class="bp">Result</span> <span class="o">:=</span> <span class="bp">Result</span> <span class="k">mod</span> <span class="mi">11</span> <span class="k">mod</span> <span class="mi">10</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>In Ruby:
<span style="border: 3px solid blue; color:blue;font-weight: bold">19</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># where mpan is a string</span>
<span class="k">def</span> <span class="nf">check_digit</span><span class="p">(</span><span class="n">mpan</span><span class="p">)</span>
  <span class="n">primes</span> <span class="o">=</span> <span class="o">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="o">]</span>
  <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">n</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">mpan</span><span class="o">[</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">].</span><span class="n">to_i</span> <span class="o">*</span> <span class="n">primes</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="p">)</span> <span class="p">}</span> <span class="o">%</span> <span class="mi">11</span> <span class="o">%</span> <span class="mi">10</span>
<span class="k">end</span>
</pre></div>
<p>In Visual Basic:
<span style="border: 3px solid blue; color:blue;font-weight: bold">20</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">Public</span> <span class="k">Function</span> <span class="nf">mpancheck</span><span class="p">(</span><span class="n">mpan</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>

  <span class="c">' Michael Diarmid (EDF)</span>
  <span class="c">' Updated 04/08/2010 MD</span>
  <span class="c">' Returns True / False if MPAN is valid</span>
  
<span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">inval</span>

   <span class="k">Dim</span> <span class="n">c</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">,</span> <span class="n">sum</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="n">i</span> <span class="ow">as</span> <span class="kt">Byte</span>   
   <span class="n">c</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">)</span>

   <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="mi">12</span>
           <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">mpan</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
   <span class="k">Next</span> <span class="n">i</span>

   <span class="k">If</span> <span class="n">Right</span><span class="p">(</span><span class="n">mpan</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">sum</span> <span class="ow">Mod</span> <span class="mi">11</span><span class="p">)</span> <span class="ow">Mod</span> <span class="mi">10</span><span class="p">)</span> <span class="k">Then</span>
           <span class="n">mpancheck</span> <span class="o">=</span> <span class="k">True</span>
   <span class="k">Else</span>
<span class="n">inval</span><span class="p">:</span>
       <span class="n">mpancheck</span> <span class="o">=</span> <span class="k">False</span>
   <span class="k">End</span> <span class="k">If</span>
 
<span class="k">End</span> <span class="k">Function</span>
</pre></div>
<p>In VisualBasic.Net 2010:
<span style="border: 3px solid blue; color:blue;font-weight: bold">21</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">Public</span> <span class="k">Function</span> <span class="nf">mpancheck</span><span class="p">(</span><span class="n">mpan</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>

        <span class="c">' Michael Diarmid (EDF)</span>
        <span class="c">' Updated 04/08/2010 MD</span>
        <span class="c">' Returns True / False if MPAN is valid</span>
        <span class="c">' Revised by Tym Huckin (16/03/2012) for VB 2010</span>

        <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">inval</span>

        <span class="k">Dim</span> <span class="n">c</span> <span class="ow">As</span> <span class="kt">Object</span><span class="p">,</span> <span class="n">sum</span> <span class="ow">As</span> <span class="kt">Integer</span>

        <span class="n">c</span> <span class="o">=</span> <span class="k">New</span> <span class="n">List</span><span class="p">(</span><span class="k">Of</span> <span class="kt">Integer</span><span class="p">)</span> <span class="n">From</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">}</span>

        <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="mi">12</span>
            <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">mpan</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">Next</span> <span class="n">i</span>

        <span class="k">If</span> <span class="n">sRight</span><span class="p">(</span><span class="n">mpan</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">sum</span> <span class="ow">Mod</span> <span class="mi">11</span><span class="p">)</span> <span class="ow">Mod</span> <span class="mi">10</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Return</span> <span class="k">True</span>
        <span class="k">Else</span>
<span class="n">inval</span><span class="p">:</span>
            <span class="k">Return</span> <span class="k">False</span>
        <span class="k">End</span> <span class="k">If</span>

    <span class="k">End</span> <span class="k">Function</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">sRight</span><span class="p">(</span><span class="n">sSTRING</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">iLEN</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">Dim</span> <span class="n">sRET</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>
        <span class="k">Try</span>
            <span class="k">If</span> <span class="n">iLEN</span> <span class="o">&gt;=</span> <span class="n">Len</span><span class="p">(</span><span class="n">sSTRING</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">sRET</span> <span class="o">=</span> <span class="n">sSTRING</span>
            <span class="k">End</span> <span class="k">If</span>
            <span class="n">sRET</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sSTRING</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sSTRING</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">iLEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">iLEN</span><span class="p">)</span>
        <span class="k">Catch</span> <span class="n">ex</span> <span class="ow">As</span> <span class="n">Exception</span>
            <span class="n">sRET</span> <span class="o">=</span> <span class="s">""</span>
        <span class="k">End</span> <span class="k">Try</span>
        <span class="k">Return</span> <span class="n">sRET</span>

    <span class="k">End</span> <span class="k">Function</span>
</pre></div>
<p>Or VB.Net 2010, avoiding the use of VB6 Compatibility LibraryÂ :
<span style="border: 3px solid blue; color:blue;font-weight: bold">22</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>	<span class="c">''' &lt;summary&gt;</span>
	<span class="c">''' Validates an MPAN number</span>
	<span class="c">''' &lt;/summary&gt;</span>
	<span class="c">''' &lt;param name="mpan"&gt;At least the last 13 digits from the MPAN number, including the check digit, </span>
	<span class="c">''' expressed as a string&lt;/param&gt;</span>
	<span class="c">''' &lt;returns&gt;True for valid, otherwise false&lt;/returns&gt;</span>
	<span class="c">''' &lt;remarks&gt;Written by Martin Milan, May 2012, avoiding use of VB6 compatibility library, for .Net 4.0 Client Profile&lt;/remarks&gt;</span>
	<span class="k">Public</span> <span class="k">Function</span> <span class="nf">MPANIsValid</span><span class="p">(</span><span class="n">mpan</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
		
		<span class="c">' Set initial conditions.</span>
		<span class="k">Dim</span> <span class="n">validationResult</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
		
		<span class="k">If</span> <span class="n">mpan</span><span class="p">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="k">Then</span>
			
			<span class="c">'Read the check digit into an Integer variable.</span>
			<span class="k">Dim</span> <span class="n">intCheckDigit</span> <span class="ow">As</span> <span class="kt">Integer</span>
			<span class="k">If</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">intCheckDigit</span><span class="p">)</span> <span class="k">Then</span>
				
				<span class="k">Dim</span> <span class="n">strTest</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">mpan</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Length</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
				<span class="k">Dim</span> <span class="n">intPrimes</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">}</span>
				<span class="k">Dim</span> <span class="n">productTotal</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">Dim</span> <span class="n">blnError</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
				
				<span class="k">For</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="mi">11</span> <span class="k">Step</span> <span class="mi">1</span>
					<span class="k">Dim</span> <span class="n">intTestDigit</span> <span class="ow">As</span> <span class="kt">Integer</span>
					<span class="k">If</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">intTestDigit</span><span class="p">)</span> <span class="k">Then</span>
						<span class="n">productTotal</span> <span class="o">+=</span> <span class="p">(</span><span class="n">intTestDigit</span> <span class="o">*</span> <span class="n">intPrimes</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
					<span class="k">Else</span>
						<span class="n">blnError</span> <span class="o">=</span> <span class="k">True</span>
						<span class="k">Exit</span> <span class="k">For</span>
					<span class="k">End</span> <span class="k">If</span>
				<span class="k">Next</span>
				
				<span class="k">If</span> <span class="k">Not</span> <span class="n">blnError</span> <span class="k">Then</span>
					<span class="n">validationResult</span> <span class="o">=</span> <span class="p">((</span><span class="n">productTotal</span> <span class="ow">Mod</span> <span class="mi">11</span> <span class="ow">Mod</span> <span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">intCheckDigit</span><span class="p">)</span>	
				<span class="k">Else</span>
					<span class="n">validationResult</span> <span class="o">=</span> <span class="k">False</span> <span class="c">' Due to a parsing error.	</span>
				<span class="k">End</span> <span class="k">If</span>
				
			<span class="k">End</span> <span class="k">If</span>
			
		<span class="k">End</span> <span class="k">If</span>
		
		<span class="k">Return</span> <span class="n">validationResult</span>
		
	<span class="k">End</span> <span class="k">Function</span>
</pre></div>
<p>In C#:
<span style="border: 3px solid blue; color:blue;font-weight: bold">23</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno"> 1 </span>	<span class="c1">/// &lt;summary&gt;</span>
<span class="lineno"> 2 </span>	<span class="c1">/// Validates an MPAN number</span>
<span class="lineno"> 3 </span>	<span class="c1">/// &lt;/summary&gt;</span>
<span class="lineno"> 4 </span>	<span class="c1">/// &lt;param name="mpan"&gt;At least the last 13 digits from the MPAN number, including the check digit, </span>
<span class="lineno"> 5 </span>	<span class="c1">/// expressed as a string&lt;/param&gt;</span>
<span class="lineno"> 6 </span>	<span class="c1">/// &lt;returns&gt;True for valid, otherwise false&lt;/returns&gt;</span>
<span class="lineno"> 7 </span>	<span class="c1">/// &lt;remarks&gt;Written by Martin Milan, May 2012, for .Net 4.0 Client Profile&lt;/remarks&gt;</span>
<span class="lineno"> 8 </span>	<span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">MPANIsValid</span><span class="p">(</span><span class="kt">string</span> <span class="n">mpan</span><span class="p">)</span>
<span class="lineno"> 9 </span>	<span class="p">{</span>
<span class="lineno">10 </span>
<span class="lineno">11 </span>		<span class="c1">// Set initial conditions.</span>
<span class="lineno">12 </span>		<span class="kt">bool</span> <span class="n">validationResult</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">13 </span>
<span class="lineno">14 </span>		<span class="k">if</span> <span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">12</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">15 </span>
<span class="lineno">16 </span>			<span class="c1">//Read the check digit into an Integer variable.</span>
<span class="lineno">17 </span>			<span class="kt">int</span> <span class="n">intCheckDigit</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="lineno">18 </span>			<span class="k">if</span> <span class="p">(</span><span class="kt">int</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">),</span> <span class="k">out</span> <span class="n">intCheckDigit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">19 </span>
<span class="lineno">20 </span>				<span class="kt">string</span> <span class="n">strTest</span> <span class="p">=</span> <span class="n">mpan</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">13</span><span class="p">,</span> <span class="m">12</span><span class="p">);</span>
<span class="lineno">21 </span>				<span class="kt">int</span><span class="p">[]</span> <span class="n">intPrimes</span> <span class="p">=</span> <span class="p">{</span><span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">17</span><span class="p">,</span> <span class="m">19</span><span class="p">,</span> <span class="m">23</span><span class="p">,</span> <span class="m">29</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">37</span><span class="p">,</span> <span class="m">41</span><span class="p">,</span> <span class="m">43</span><span class="p">};</span>
<span class="lineno">22 </span>				<span class="kt">int</span> <span class="n">productTotal</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="lineno">23 </span>				<span class="kt">bool</span> <span class="n">blnError</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">24 </span>
<span class="lineno">25 </span>				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="m">11</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
<span class="lineno">26 </span>					<span class="kt">int</span> <span class="n">intTestDigit</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="lineno">27 </span>					<span class="k">if</span> <span class="p">(</span><span class="kt">int</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">strTest</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="k">out</span> <span class="n">intTestDigit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">28 </span>						<span class="n">productTotal</span> <span class="p">+=</span> <span class="p">(</span><span class="n">intTestDigit</span> <span class="p">*</span> <span class="n">intPrimes</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="lineno">29 </span>					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">30 </span>						<span class="n">blnError</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">31 </span>						<span class="k">break</span><span class="p">;</span> 
<span class="lineno">32 </span>					<span class="p">}</span>
<span class="lineno">33 </span>				<span class="p">}</span>
<span class="lineno">34 </span>
<span class="lineno">35 </span>				<span class="k">if</span> <span class="p">(!</span><span class="n">blnError</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">36 </span>					<span class="n">validationResult</span> <span class="p">=</span> <span class="p">((</span><span class="n">productTotal</span> <span class="p">%</span> <span class="m">11</span> <span class="p">%</span> <span class="m">10</span><span class="p">)</span> <span class="p">==</span> <span class="n">intCheckDigit</span><span class="p">);</span>
<span class="lineno">37 </span>				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">38 </span>					<span class="n">validationResult</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// Due to a parsing error.	</span>
<span class="lineno">39 </span>				<span class="p">}</span>
<span class="lineno">40 </span>
<span class="lineno">41 </span>			<span class="p">}</span>
<span class="lineno">42 </span>
<span class="lineno">43 </span>		<span class="p">}</span>
<span class="lineno">44 </span>
<span class="lineno">45 </span>		<span class="k">return</span> <span class="n">validationResult</span><span class="p">;</span>
<span class="lineno">46 </span>
<span class="lineno">47 </span>	<span class="p">}</span>
</pre></div>
<p>As a formula in Excel:
<span style="border: 3px solid blue; color:blue;font-weight: bold">24</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>'MPAN in Cell A1

=IF(TEXT((MOD(MOD(SUM((MID(A1,1,1)*3),(MID(A1,2,1)*5),(MID(A1,3,1)*7),(MID(A1,4,1)*13),
(MID(A1,5,1)*17),(MID(A1,6,1)*19),(MID(A1,7,1)*23),(MID(A1,8,1)*29),(MID(A1,9,1)*31),
(MID(A1,10,1)*37),(MID(A1,11,1)*41),(MID(A1,12,1)*43)),11),10)),0)=TEXT(TRIM(RIGHT(A1,1)),
0),"Correct","Invalid Mpan")
</pre></div>
<p>In Python:
<span style="border: 3px solid blue; color:blue;font-weight: bold">25</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">check_digit</span><span class="p">(</span><span class="n">mpan</span><span class="p">):</span>
    <span class="sd">""" </span>
<span class="sd">        @mpan = The first 12 digits of the MPAN number, excluding the check digit</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span> <span class="k">for</span> <span class="n">prime</span><span class="p">,</span> <span class="n">digit</span> <span class="ow">in</span> \
            <span class="nb">zip</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span> <span class="n">mpan</span><span class="p">))</span> <span class="o">%</span> <span class="mi">11</span> <span class="o">%</span> <span class="mi">10</span>
</pre></div>
<p>In PL/SQL:
<span style="border: 3px solid blue; color:blue;font-weight: bold">26</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">create</span> <span class="k">or</span> <span class="k">replace</span> <span class="k">function</span> <span class="n">mpan_check</span><span class="p">(</span><span class="n">mpan</span> <span class="k">in</span> <span class="n">varchar2</span><span class="p">)</span> <span class="k">return</span> <span class="nb">boolean</span> <span class="k">is</span>
  <span class="c1">--CDP ATKINSON</span>
  <span class="n">res</span> <span class="nb">integer</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">TYPE</span> <span class="n">prime_tab</span> <span class="k">IS</span> <span class="n">VARRAY</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="k">OF</span> <span class="nb">integer</span><span class="p">;</span>
  <span class="n">primes</span> <span class="n">prime_tab</span> <span class="p">:</span><span class="o">=</span> <span class="n">prime_tab</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">);</span>
<span class="k">begin</span>  
  <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">..</span><span class="mi">12</span> <span class="n">loop</span>    
    <span class="n">res</span> <span class="p">:</span><span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="n">to_number</span><span class="p">(</span> <span class="n">substr</span><span class="p">(</span> <span class="n">mpan</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">primes</span> <span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="k">end</span> <span class="n">loop</span><span class="p">;</span>  
  <span class="k">return</span> <span class="n">to_char</span><span class="p">(</span><span class="k">mod</span><span class="p">(</span><span class="k">mod</span><span class="p">(</span><span class="n">res</span> <span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">mpan</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">end</span> <span class="n">mpan_check</span><span class="p">;</span>
</pre></div>
<p>In Javascript:
<span style="border: 3px solid blue; color:blue;font-weight: bold">27</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">//Oliver Grimes</span>

        <span class="kd">function</span> <span class="nx">checkMPAN</span><span class="p">(</span><span class="nx">mpan</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">primes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">mpan</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">===</span> <span class="nx">primes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">primes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">sum</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="o">*</span> <span class="nx">primes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="nx">sum</span> <span class="o">%</span> <span class="mi">11</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">===</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>
            <span class="p">}</span>
    
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>
<p>In PHP:
<span style="border: 3px solid blue; color:blue;font-weight: bold">28</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">checkMPAN</span><span class="p">(</span><span class="nv">$mpan</span><span class="p">)</span>
    <span class="p">{</span>
    	<span class="nv">$primes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">);</span>
    	<span class="nv">$sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    	<span class="nv">$mpan</span> <span class="o">=</span> <span class="nb">str_split</span><span class="p">(</span><span class="nv">$mpan</span><span class="p">);</span>
    	
    	<span class="k">if</span> <span class="p">((</span><span class="nb">count</span><span class="p">(</span><span class="nv">$mpan</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$primes</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$primes</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    		<span class="nv">$sum</span> <span class="o">+=</span> <span class="nv">$mpan</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">*</span> <span class="nv">$primes</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
    	    <span class="p">}</span>
    	    <span class="k">return</span> <span class="p">((</span><span class="nv">$sum</span> <span class="o">%</span> <span class="mi">11</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="nb">end</span><span class="p">(</span><span class="nv">$mpan</span><span class="p">))</span> <span class="o">?</span> <span class="k">true</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
    	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    	    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    	<span class="p">}</span>
    <span class="p">}</span>
</pre></div>
<p>In SQL Server:
<span style="border: 3px solid blue; color:blue;font-weight: bold">29</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">is_valid_mpan</span> 
<span class="p">(</span>  <span class="o">@</span><span class="n">mpan</span>    <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="p">)</span>
<span class="k">RETURNS</span> <span class="nb">INT</span>
<span class="k">AS</span>
  <span class="k">BEGIN</span>
	<span class="c1">--Tim Foster (2013-01-04)</span>
	<span class="k">DECLARE</span> <span class="o">@</span><span class="n">is_mpan</span>	<span class="nb">INT</span>
		<span class="p">,</span><span class="o">@</span><span class="n">x</span>		<span class="nb">INT</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="p">,</span><span class="o">@</span><span class="k">sum</span>		<span class="nb">INT</span> <span class="o">=</span> <span class="mi">0</span>
			
	<span class="k">DECLARE</span>	<span class="o">@</span><span class="n">arr</span>	<span class="k">TABLE</span> <span class="p">(</span><span class="n">id</span> <span class="nb">INT</span> <span class="k">IDENTITY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">val</span> <span class="nb">INT</span><span class="p">)</span>
	
	<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">arr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="mi">5</span><span class="p">),(</span><span class="mi">7</span><span class="p">),(</span><span class="mi">13</span><span class="p">),(</span><span class="mi">17</span><span class="p">),(</span><span class="mi">19</span><span class="p">),(</span><span class="mi">23</span><span class="p">),(</span><span class="mi">29</span><span class="p">),(</span><span class="mi">31</span><span class="p">),(</span><span class="mi">37</span><span class="p">),(</span><span class="mi">41</span><span class="p">),(</span><span class="mi">43</span><span class="p">)</span>
	
	<span class="n">WHILE</span> <span class="o">@</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">12</span>
	  <span class="k">BEGIN</span>
		<span class="k">SELECT</span>	<span class="o">@</span><span class="k">sum</span>	<span class="o">=</span> <span class="o">@</span><span class="k">sum</span> <span class="o">+</span> <span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">mpan</span><span class="p">,</span> <span class="o">@</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>
		<span class="k">FROM</span>	<span class="o">@</span><span class="n">arr</span>
		<span class="k">WHERE</span>	<span class="n">id</span>	<span class="o">=</span> <span class="o">@</span><span class="n">x</span>
		
		<span class="k">SELECT</span> <span class="o">@</span><span class="n">x</span> <span class="o">=</span> <span class="o">@</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
	  <span class="k">END</span>
	  
	<span class="k">IF</span> <span class="k">RIGHT</span><span class="p">(</span><span class="o">@</span><span class="n">mpan</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="o">@</span><span class="k">sum</span> <span class="o">%</span> <span class="mi">11</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span>
	  <span class="k">BEGIN</span>
		<span class="k">SELECT</span> <span class="o">@</span><span class="n">is_mpan</span> <span class="o">=</span> <span class="mi">1</span>
	  <span class="k">END</span>
	<span class="k">ELSE</span>
	  <span class="k">BEGIN</span>
		<span class="k">SELECT</span> <span class="o">@</span><span class="n">is_mpan</span> <span class="o">=</span> <span class="mi">0</span>
	  <span class="k">END</span>

	<span class="k">RETURN</span> <span class="o">@</span><span class="n">is_mpan</span>
<span class="k">END</span>
</pre></div>
<p>In Swift 3 is:
<span style="border: 3px solid blue; color:blue;font-weight: bold">30</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span> <span class="kd">func</span> <span class="nf">isValid</span><span class="p">(</span><span class="n">mpan</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nv">primes</span> <span class="p">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">]</span>
        <span class="kd">let</span> <span class="nv">chars</span> <span class="p">=</span> <span class="nb">Array</span><span class="p">(</span><span class="n">mpan</span><span class="p">.</span><span class="n">characters</span><span class="p">).</span><span class="bp">map</span><span class="p">({</span><span class="nb">Int</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nv">$0</span><span class="p">))}).</span><span class="n">flatMap</span><span class="p">({</span><span class="nv">$0</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">zip</span><span class="p">(</span><span class="n">primes</span><span class="p">,</span> <span class="n">chars</span><span class="p">).</span><span class="bp">reduce</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">+</span> <span class="nv">$1</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span> <span class="nv">$1</span><span class="p">.</span><span class="mi">1</span><span class="p">}</span> <span class="o">%</span> <span class="mi">11</span> <span class="o">%</span> <span class="mi">10</span> <span class="p">==</span> <span class="n">chars</span><span class="p">.</span><span class="bp">last</span><span class="p">!</span>
    <span class="p">}</span>
</pre></div>
<p>In Apex (Salesforce):
<span style="border: 3px solid blue; color:blue;font-weight: bold">31</span></p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno"> 1 </span>    <span class="cm">/**</span>
<span class="lineno"> 2 </span><span class="cm">    * @description Validates an MPAN. Written by Adam Dry June 2018. Apex version 43</span>
<span class="lineno"> 3 </span><span class="cm">    * @param mpan the 13 digit MPAN including the check digit on the end</span>
<span class="lineno"> 4 </span><span class="cm">    */</span>
<span class="lineno"> 5 </span>    <span class="kd">public</span> <span class="n">Boolean</span> <span class="nf">mpanIsValid</span><span class="o">(</span><span class="n">String</span> <span class="n">mpan</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno"> 6 </span>
<span class="lineno"> 7 </span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">primes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;{</span><span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">19</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span> <span class="mi">43</span><span class="o">};</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span>        <span class="c1">// Read the check digit into an Integer variable</span>
<span class="lineno">10 </span>        <span class="n">Integer</span> <span class="n">checkDigit</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">mpan</span><span class="o">.</span><span class="na">right</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span>        <span class="n">String</span> <span class="n">strTest</span> <span class="o">=</span> <span class="n">mpan</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">12</span><span class="o">);</span>
<span class="lineno">13 </span>        <span class="n">Integer</span> <span class="n">productTotal</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="lineno">14 </span>
<span class="lineno">15 </span>        <span class="k">for</span> <span class="o">(</span><span class="n">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">11</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="lineno">16 </span>            <span class="n">Integer</span> <span class="n">testDigit</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">strTest</span><span class="o">.</span><span class="na">Substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">));</span>
<span class="lineno">17 </span>            <span class="n">productTotal</span> <span class="o">+=</span> <span class="o">(</span><span class="n">testDigit</span> <span class="o">*</span> <span class="n">primes</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
<span class="lineno">18 </span>        <span class="o">}</span>
<span class="lineno">19 </span>
<span class="lineno">20 </span>        <span class="n">Integer</span> <span class="n">computedCheck</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">mod</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">mod</span><span class="o">(</span><span class="n">productTotal</span><span class="o">,</span> <span class="mi">11</span><span class="o">),</span> <span class="mi">10</span><span class="o">);</span>        
<span class="lineno">21 </span>        <span class="n">Boolean</span> <span class="n">validationResult</span> <span class="o">=</span> <span class="o">(</span><span class="n">computedCheck</span> <span class="o">==</span> <span class="n">checkDigit</span><span class="o">);</span>
<span class="lineno">22 </span>
<span class="lineno">23 </span>        <span class="k">return</span> <span class="n">validationResult</span><span class="o">;</span>
<span class="lineno">24 </span>    <span class="o">}</span>
</pre></div>
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="MPAN_state">MPAN state</span></h2>
<p>The supply identified by the MPAN can be in one of four states: disconnected, de-energised, live, and new.
<span style="border: 3px solid blue; color:blue;font-weight: bold">32</span></p>
<ul><li>Disconnected: The service cable has been removed and the MPAN will not be reused.</li>
<li>De-energised: The service cable is in place, but the fuse has been removed. The meter remains connected to the distribution network, but no electricity can be used.</li>
<li>Live: Both the service cable and the fuse are in place. The supply is fully operational.</li>
<li>New: A new MPAN has been generated, however, the top line (supplementary data consisting of the Profile Class and Meter Time-Switch Code) is not yet complete. The service cable may or may not be installed.</li></ul>
<p>These terms are by no means standardised. For example, a disconnected supply might be referred to as a 'dead' supply.
<span style="border: 3px solid blue; color:blue;font-weight: bold">33</span></p>
<h2><span class="mw-headline" id="Export_MPANs">Export MPANs</span></h2>
<p>The vast majority of MPANs are import MPANs, where energy is being consumed. However, if a supply exports to the distribution network, then an export MPAN is issued. If a supply both imports and exports, then both an import MPAN and export MPAN are issued.
<span style="border: 3px solid blue; color:blue;font-weight: bold">34</span></p>
<h3><span class="mw-headline" id="Microgeneration">Microgeneration</span></h3>
<p>Formerly, export MPANs required a half-hourly compliant meter to be installed. Since 2003, it has been possible for microgeneration projects, with a capacity of 30Â kW or below, to have a non-half-hourly meter to export back into the distribution network. The uptake was slow, with the first microgeneration export MPAN being issued in June 2005. Some suppliers may not bother to register the export MPAN in MPAS as the revenue is so small.  Export capacity over 30Â kW is required to be half-hourly metered.
<span style="border: 3px solid blue; color:blue;font-weight: bold">35</span></p>
<h2><span class="mw-headline" id="Metered_Supply_Point">Metered Supply Point</span></h2>
<p>The Metered Supply Point (MSP) is the point at which the meter measuring a customer's consumption is located. It is thus also the point at which either the distribution network operator's supply, or the building network operator's lateral cable, terminates and the customer's equipment begins. In order to firmly establish a supply's MSP, the MPAN needs to be associated with a meter serial number.
<span style="border: 3px solid blue; color:blue;font-weight: bold">36</span></p><p>Although it is common for an MPAN to be associated with one meter serial number, in some cases there is a many-to-many relationship. For example, one meter could be associated with both an import and an export MPAN, or one MPAN could be measured by three separate meters.
<span style="border: 3px solid blue; color:blue;font-weight: bold">37</span></p>
<h2><span id="Metering_Code_of_Practice.5B13.5D"></span><span class="mw-headline" id="Metering_Code_of_Practice[13]">Metering Code of Practice</span></h2>
<table >
<caption>Code of Practice
</caption>
<tbody><tr>
<th>Code
</th>
<th>Range
</th>
<th>Configuration
</th></tr>
<tr>
<td>COP10
</td>
<td>less than 72Â kW
</td>
<td>One HH whole current meter installed. Introduced for February 2009.
</td></tr>
<tr>
<td>COP5
</td>
<td>less than 1MW
</td>
<td>One HH meter installed.
</td></tr>
<tr>
<td>COP3
</td>
<td>1MW to 10MW
</td>
<td>Two meters installed, main and check, both recording the same load. The main meter being used for billing.
</td></tr>
<tr>
<td>COP2
</td>
<td>10MW to 100MW
</td>
<td>Two meters installed as in COP3, but higher-accuracy class meters.
</td></tr>
<tr>
<td>COP1
</td>
<td>&gt; 100MW
</td>
<td>Very few sites in the UK at this level, generally power stations and connections with the National Grid.
</td></tr></tbody></table><a name="table5"><span style='border: 3px solid #00cc00;color:#00cc00;font-size: 24px;'>5</span></a>
<h2><span class="mw-headline" id="Unmetered_supplies">Unmetered supplies</span></h2>
<p>It is possible for small predictable supplies to be unmetered. Examples are street lights, traffic signals, signs, bollards, telephone kiosks, CCTV and advertising displays.
<span style="border: 3px solid blue; color:blue;font-weight: bold">38</span></p><p>For a piece of equipment to be connected to the distribution network via an unmetered connection, its consumption should not exceed 500Â watts and it should operate in a predictable manner, with no provision for it to be manually turned on at the end user's request. Generally the equipment would either be in operation and taking a supply of electricity 24 hours a day, or be controlled by a photocell, as is often the case for street lights.
<span style="border: 3px solid blue; color:blue;font-weight: bold">39</span></p><p>It is the customer's responsibility to maintain an accurate and up-to-date inventory of unmetered supplies, and to inform the UMSO (UnMetered Supplies Operator) of all changes to the connected equipment.
<span style="border: 3px solid blue; color:blue;font-weight: bold">40</span></p><p>Larger local authorities tend to trade their unmetered energy on a half-hourly basis. To do so, they employ a meter administrator who will use daily data from a photo-electric control unit (PECU) array which is then used to calculate the energy consumption. A PECU array is a device that holds a representative number of the photocells that authority uses on their street lights or traffic signals. By trading energy as unmetered half-hourly the authority will accurately pay for the energy consumed by their declared unmetered equipment, and because the data is downloaded daily the authority will see their energy invoices change throughout the year to represent the changes in season and daily lighting levels.
<span style="border: 3px solid blue; color:blue;font-weight: bold">41</span></p><p>If, however, the unmetered supplies are being traded as non half-hourly the UMSO undertakes the responsibility to calculate an EAC (Estimated Annual Consumption). This is done using a simple formula which takes into account the circuit watts of the equipment and the annual hours of operation. For example, a piece of equipment that is in use 24 hours per day will have annual hours of 8766. For, say, a CCTV camera rated at 24 circuit watts the EAC would be 210.384kWh, calculated as circuit watts x annual hours divided by 1000.
<span style="border: 3px solid blue; color:blue;font-weight: bold">42</span></p><p>If the equipment is street lighting the same process is used; however, the annual hours will change as each photocell is assigned a set number of annual hours which indicate how and when the lights turn on and off. These annual hours have been set by Elexon and are not locally agreed with the UMSO by the customer.
<span style="border: 3px solid blue; color:blue;font-weight: bold">43</span></p><p>Once an EAC calculation has taken place, an EAC Certificate is provided to the customer's appointed electricity supplier for billing, with an electronic copy of the EAC being sent to the appointed data collector. The DNO make a Distribution Use of System charge on the electricity supplier for the delivery of the electricity to the customer's unmetered equipment.
<span style="border: 3px solid blue; color:blue;font-weight: bold">44</span></p>
<h2><span id="Standard_Settlement_Configuration_.28SSC.29"></span><span class="mw-headline" id="Standard_Settlement_Configuration_(SSC)">Standard Settlement Configuration (SSC)</span></h2>
<p>Each non-half-hourly supply has a four digit code called the Standard Settlement Configuration (SSC), which specifies the number of registers a meter has, and the times that each register is recording electricity usage. The times that a register is recording is specified with a five digit code Time Pattern Regime (TPR). So for example a supply with SSC 0943 has two registers with TPRs 00404 and 00405. The 00404 TPR register records from 01:00 to 02:30 and 08:00 to 23:30, and the 00405 register records for the rest of the time.
<span style="border: 3px solid blue; color:blue;font-weight: bold">45</span></p>
<h2><span class="mw-headline" id="Meter_Point_Administration_System">Meter Point Administration System</span></h2>
<p>Each DNO operates a Meter Point Administration System (MPAS) which holds the following information for each MPAN:
<span style="border: 3px solid blue; color:blue;font-weight: bold">46</span></p>
<ul><li>Supplier</li>
<li>Data Collector (DC)</li>
<li>Data Aggregator (DA)</li>
<li>Meter Operator (MOP) or Meter Administrator for HH unmetered</li>
<li>Customer</li>
<li>Address of the exit point</li>
<li>Associated MPANs</li>
<li>MPAN state</li>
<li>Profile Class (PC)</li>
<li>Line Loss Factor Class (LLFC)</li>
<li>Meter Time Switch Class (MTC)</li>
<li>GSP Group</li></ul>
<p>MPRS is the name of the software package that implements the MPAS system for all DNOs. Since MPRS is used by most DNOs it is often used interchangeably with the term MPAS.
<span style="border: 3px solid blue; color:blue;font-weight: bold">47</span></p>
<h2><span class="mw-headline" id="ECOES">ECOES</span></h2>
<p>ECOES (Electricity Central Online Enquiry Service) is a website that allows users and authorised industry parties to search for supply details (past and present) using such things as the 13-digit MPAN bottom line number, the meter serial number or the postcode. The user can determine a wide range of data relating to the supply including the full address, meter details, the current energisation status and also the appointed parties (i.e. the supplier, distributor, MOP, DC and DA). The site is populated from information sent from the supplier regarding the metering system.
<span style="border: 3px solid blue; color:blue;font-weight: bold">48</span></p><p>Only non-domestic users (with two valid MPAN's that are not Class 1 or 2) can register to access this service.
<span style="border: 3px solid blue; color:blue;font-weight: bold">49</span></p>
<script>function offsetAnchor() {if(location.hash.length !== 0) {window.scrollTo(window.scrollX, window.scrollY - 250);}}window.addEventListener("hashchange", offsetAnchor);window.setTimeout(offsetAnchor, 1);</script>